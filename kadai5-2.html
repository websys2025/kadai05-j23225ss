<html lang="ja">
<head>
    <meta charset="utf-8">
    <title>演習課題5-2：外部APIの呼び出しテスト</title>
</head>
<body>
    <h1 id="msg">天気予報API</h1>
    <form name="apiform"><p>
        地域番号6桁：<input type="text" name="code">
        <button type="button" id="btn1" onclick="api(this.form)">実行</button>
    </p></form>
    
    <div id="result">結果はここに表示</div>
    <script>
        async function api(myForm) {
            const endpoint = "https://www.jma.go.jp/bosai/forecast/data/forecast/";
            // ここにコードを書く
            //console.log(myForm.code.value);
            const call = endpoint + myForm.code.value + ".json";
            // zipcloudのAPI呼び出して結果を表示する
            const aRes = await fetch(call);
            const data = await aRes.text();
            //onsole.log(data);
            const data_json = JSON.parse(data);
            //console.log(data_json.publishingOffice);
            //var elem = document.getElementById("publishingOffice");
            //elem.innerText = data.name;

            document.getElementById("result").innerHTML = data; // 現状ではそのまま表示しているだけ
        }
    </script>
</body>
</html>
